---
title: Demo of controllers and resources
---
#### Setup
  * We're going to build a simple blogging system
  * Posts and comments
  * Do these commands in the shell
<%= code_begin %>
rails new resdemo
cd resdemo
rails generate scaffold Post title:string body:text
rails generate scaffold Comment body:text post_id:integer
rails db:migrate
<%= code_end %>

#### Review
* Examine db/migrations/*
* Examine app/models/*
* Examine config/routes.rb
* Examine app/controllers
* Examine app/views

#### Routes
* Run `rails routes`
<%= code_begin %>
Prefix Verb   URI Pattern                  Controller#Action
comments GET    /comments(.:format)          comments#index
       POST   /comments(.:format)          comments#create
new_comment GET    /comments/new(.:format)      comments#new
edit_comment GET    /comments/:id/edit(.:format) comments#edit
comment GET    /comments/:id(.:format)      comments#show
       PATCH  /comments/:id(.:format)      comments#update
       PUT    /comments/:id(.:format)      comments#update
       DELETE /comments/:id(.:format)      comments#destroy
 posts GET    /posts(.:format)             posts#index
       POST   /posts(.:format)             posts#create
new_post GET    /posts/new(.:format)         posts#new
edit_post GET    /posts/:id/edit(.:format)    posts#edit
  post GET    /posts/:id(.:format)         posts#show
       PATCH  /posts/:id(.:format)         posts#update
       PUT    /posts/:id(.:format)         posts#update
       DELETE /posts/:id(.:format)         posts#destroy
..
<%= code_end %>

#### Play with the server
* Run the rails server (`rails server`)
* Access these urls from your browser observe error messages, and refer to rake routes above
  * http://0.0.0.0:3000/posts
    * Now create one post

  * http://0.0.0.0:3000/comments
    * Now create one comment

  * http://0.0.0.0:3000/posts/1
  * http://0.0.0.0:3000/comments/1

##### But: http://0.0.0.0:3000/posts/1/comments

#### Updates to make nesting work

* Update routes to parse the right thing
* Add belongs_to and has_many added to model
* Patch data in sample records to have the post_id point to the post
* Update the comment controller supply the relevant post
* Look at the comments index.erb.html and fix to use new helpers
* Update the Comment create view to create the link
* Update the comment create controller to create the link
* Add "add comment link"
* Update the comment create controller again to represent the nested form
* More and more steps
